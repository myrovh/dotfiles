#!/bin/bash

# not running interactively then bail
[[ $- != *i* ]] && return

# Check if zplug is installed
if [[ ! -d ~/.zplug ]]; then
	git clone https://github.com/zplug/zplug ~/.zplug
	source ~/.zplug/init.zsh && zplug update
else
	source ~/.zplug/init.zsh
fi

# zplug plugins
zplug "zplug/zplug", hook-build:"zplug --self-manage"
zplug "yous/vanilli.sh"
zplug "mafredri/zsh-async"
zplug "supercrabtree/k"
zplug "zsh-users/zsh-autosuggestions"
zplug "sindresorhus/pure", use:pure.zsh, as:theme
zplug "petervanderdoes/git-flow-completion"

# install missing plugins
zplug check || zplug install

# Then, source plugins and add commands to $PATH
zplug load

# set nvim
export VISUAL=vim
export EDITOR=vim

# configure node
export npm_config_prefix=~/.node_modules
PATH="$HOME/.node_modules/bin:$PATH"
PATH="$HOME/.yarn/bin:$PATH"

# set generic bin path
PATH="$PATH:$HOME/bin"

# set ruby path
if hash ruby 2>/dev/null; then
	PATH="$PATH:$(ruby -e 'print Gem.user_dir')/bin"
	gem_home=$(ruby -e 'print Gem.user_dir')
	export GEM_HOME=$gem_home
fi

# set go bin path
if hash go 2>/dev/null; then
	PATH="$PATH:$HOME/go/bin"
fi

# Get wal colours
if [[ -f ~/.cache/wal/sequences ]]; then
	(cat ~/.cache/wal/sequences &)
fi

# aliases
alias dotdrop='dotdrop --cfg=~/dotfiles/config.yaml'
alias mirrors='sudo reflector --score 100 --fastest 25 --sort rate --save /etc/pacman.d/mirrorlist --verbose'
alias xgnome='startx ~/.xinitrc gnome'
alias xbudgie='startx ~/.xinitrc budgie'
alias xi3='startx ~/.xinitrc i3'
alias wgnome='XDG_SESSION_TYPE=wayland dbus-run-session gnome-session'
