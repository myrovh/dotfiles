# /bin/sh

LOG="$HOME/.config/xorg/session.log"

# Check which WM we have to run :
WINDOWMANAGER="`cat $HOME/.config/xorg/session.wm`"

# Run WM in background and get its PID.
# Redirect the standard output to the log file
# Redirect the error output to the standard output (so to the log file)
$WINDOWMANAGER >> $LOG 2>&1 &
wmpid=$!

cat $HOME/.config/xorg/session.env | while read cmd
do
     # Run each commands in background
     $cmd >> $LOG 2>&1 &
done

# Wait the end of our WM
wait $wmpid
